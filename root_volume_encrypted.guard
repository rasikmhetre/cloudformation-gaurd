let ec2_instances = Resources.*[ Type == "AWS::EC2::Instance" ]
rule check_ebs_root_volume_encrypted when %ec2_instances !empty {
    %ec2_instances.Properties.BlockDeviceMappings[ 
        DeviceName IN ["/dev/xvda", "/dev/sda1"] 
    ].Ebs.Encrypted == true
    or %ec2_instances.Properties.BlockDeviceMappings !exists
}
